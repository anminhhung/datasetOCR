A Theory Of Factorization And Genera