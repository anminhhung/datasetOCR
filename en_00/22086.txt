after a fiercely contested battle