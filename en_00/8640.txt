3 and 4 can probably be done concurrently