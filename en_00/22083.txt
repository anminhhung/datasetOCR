after a fierce battle with its jewish and muslim inhabitants