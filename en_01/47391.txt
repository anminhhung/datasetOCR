defended by walls and a castle