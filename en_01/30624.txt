caught between the spanish kingdom of castile and the moorish kingdom of granada