for much of its upper reaches