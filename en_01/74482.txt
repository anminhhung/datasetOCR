fix problems and improve existing features