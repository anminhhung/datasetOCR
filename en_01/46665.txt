Dealing with these issues is very difficult and requires coordination at many different levels of the kernel: