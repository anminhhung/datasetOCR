Collapse: How societies choose to fail or succeed